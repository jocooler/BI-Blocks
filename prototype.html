<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <link rel="stylesheet" href="sandstone-bootstrap.min.css">
	<style>
		.img-inline {
			float:left;
			margin:8px;
			max-width:100%;
		}
		.show-short .extended {
			display:none;
		}
		.show-extended .short {
			display:none;
		}
		.editHandle {
			color: #ccc;
			position: absolute;
			top: 5px;
			right: 25px;
			z-index: 20;
			cursor: pointer;
			opacity:0;
			display:none;
			transition:opacity 300ms;
		}
		.brick:hover .editHandle {
			display:block;
			opacity:1;
		}
	</style>
  </head>
  
  <body>
	<div class="container-fluid">
		<div class="jumbotron">
			<h1 class="display-3">VTrans Projects</h1>
			<p class="lead">This section discusses vital parts of our projects.</p>
			<hr class="my-2">
			<p>Projects are a key of what VTrans does. Ensuring they are on track is what we do. To see all project data, click the button below.</p>
			<p class="lead">
				<a class="btn btn-primary btn-lg" href="#" role="button">Learn more</a>
			</p>
		</div>
		
		<div class="row">
		</div>

	</div>
	
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.7/js/tether.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.5/js/bootstrap.min.js"></script>
	<script src="https://d3js.org/d3.v4.min.js"></script>
	<script src="scripts/mustache.js"></script>
	
	<script>
	function createBrick() {
		//overloaded
		// ([html] content, [{}] options)
		// ([.row] attachmentPoint, [html] content, [{}] options)
		if (arguments.length = 2){
			var row = 'body .container-fluid .row:last-of-type',
				content = arguments[0],
				options = arguments[1];
		}
		if (!options) options = {size: 6};
		options.show = "show-short";
		
		content = Mustache.render(content, options);
		var $html = $(Mustache.render('<div class="brick col-md-{{options.size}} {{options.show}}"><div class="card"><div class="card-block">{{{content}}}</div></div></div>', {content: content, options:options}));
		$(row).append($html);
		attachEditorListener($html);
	}
	
	function createRow() {
		$('body .container-fluid').append('<div class="row">');
	}
	
	function attachEditorListener($el) {

		$handle = $('<div class="editHandle">edit</div>');
		$el.prepend($handle);
		$handle.click(function() {
			displayMenu($el);
		});
	}
	
	function displayMenu($el) {
		console.log($el);
	}
	$.get('http://192.168.11.89/api/v2/legos/_table/blocks?api_key=d1b885b8d202ab320717b54d9265e360db151e69be811f38da2f24fdd09333a5', null, function(data) {
		$.each(data.resource, function (i, v) {
			createBrick(v.template, {name: v.name, short: v.short, extended: v.extended, size: 6});
		});
	});

						
	</script>
  </body>
</html>

